<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Fountain AI — Where AI Meets Market Analysis</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4"></script>
  <style>
    body { font-family: system-ui, Arial; margin: 24px; }
    h1 { margin-bottom: .25rem }
    #stamp { opacity:.7; font-size: 14px; margin-bottom: 16px }
    .row { display:flex; flex-wrap:wrap; gap:24px }
    .card { flex:1 1 520px; max-width: 820px }
    canvas { width:100%; height:420px }
  </style>
</head>
<body>
  <h1>Fountain AI</h1>
  <div id="stamp">Loading congress trade charts…</div>

  <div class="row">
    <div class="card">
      <h3>Top 10 Net Purchases (Congress)</h3>
      <canvas id="topChart"></canvas>
    </div>
    <div class="card">
      <h3>Top 10 Net Sales (Congress)</h3>
      <canvas id="bottomChart"></canvas>
    </div>
  </div>

  <script>
    let topChart, bottomChart;

    async function loadData() {
      const res = await fetch('/api/congress/top-bottom');
      const data = await res.json();
      document.getElementById('stamp').textContent =
        `Range: ${data.date_range} • Generated at ${new Date(data.generated_at).toLocaleString()}`;

      const topLabels = data.top10.map(d => d.stock);
      const topValues = data.top10.map(d => d.value);
      const botLabels = data.bottom10.map(d => d.stock);
      const botValues = data.bottom10.map(d => d.value);

      if (topChart) topChart.destroy();
      if (bottomChart) bottomChart.destroy();

      topChart = new Chart(document.getElementById('topChart'), {
        type: 'bar',
        data: { labels: topLabels, datasets: [{ label: 'Net Buy ($)', data: topValues }] },
        options: { responsive: true, scales: { y: { beginAtZero: true, ticks: { callback: v => '$' + v.toLocaleString() } } } }
      });

      bottomChart = new Chart(document.getElementById('bottomChart'), {
        type: 'bar',
        data: { labels: botLabels, datasets: [{ label: 'Net Sell ($)', data: botValues }] },
        options: { responsive: true, scales: { y: { beginAtZero: true, ticks: { callback: v => '$' + v.toLocaleString() } } } }
      });
    }

    loadData();
    // Auto-refresh every 5 minutes if you want:
    // setInterval(loadData, 5 * 60 * 1000);
  </script>
</body>
</html>
